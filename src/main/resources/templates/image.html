<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>IMAGE-HOSTING</title>
    <script th:src="@{/js/jquery-3.4.1.js}" type="text/javascript"></script>
    <script th:src="@{/js/bootstrap.js}" type="text/javascript"></script>
    <link th:href="@{/css/bootstrap.css}" type="text/css" rel="stylesheet"/>
    <link th:href="@{/css/bootstrap-theme.css}" type="text/css" rel="stylesheet"/>
    <style>
        .container {
            width: 100%;
        }

        .img-preview {
            width: auto;
            height: 120px;
        }
    </style>
</head>
<body>
<div id="image-container" class="container">
    <div id="info-container">
        <button class="btn btn-primary btn-lg" onclick="getImageInfoPage(0)">QUERY LIKE</button>
        <button class="btn btn-primary btn-lg" onclick="getAllImageInfoPage(0)">QUERY ALL</button>
    </div>
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th>序号</th>
                <th>图片</th>
                <th>分辨率</th>
                <th>上传时间</th>
                <th>图片地址</th>
                <th>预览</th>
            </tr>
            </thead>
        </table>
    </div>
    <nav aria-label="Page navigation">
        <ul id="page-nav" class="pagination">
        </ul>
    </nav>
</div>

</body>
</html>

<script type="text/javascript">

    var pageNum = 0;
    var pageSize = 3;
    var nextPage = true;

    //根据图片名 模糊查询 分页
    function getImageInfoPage(i) {

        var $imageTable = $("#image-container .table-responsive table");
        var $tableHead = "<thead><tr><th>序号</th><th>图片</th><th>分辨率</th><th>上传时间</th><th>图片地址</th><th>预览</th></tr></thead>";
        var $tableBody = "";
        var $pageNav = $("#page-nav");
        var $previousPage = "";
        var $singlePage = "";
        var $nextPage = "";

        $.get("/image/get/page", {pageNum: i, pageSize: pageSize, imageName: "0"}, function (data) {

            console.log("根据图片名 模糊查询 分页");
            console.log(data);
            if (data.length < pageSize) {
                nextPage = false;
            }

            $tableBody = "<tbody>";
            for (var j = 0; j < data.length; j++) {
                var image = data[j];
                $tableBody = $tableBody + "<tr><td>"
                    + (j + 1) + "</td><td>"
                    + image.filename + "</td><td>"
                    + image.width + "*" + image.height + "</td><td>"
                    + image.createTime + "</td><td>"
                    + image.url + "</td><td>" +
                    "<img class='img-preview' src='" + image.url + "'></td></tr>";

            }
            $tableBody = $tableBody + "</tbody>";
            $imageTable.html($tableHead + $tableBody);

            $previousPage = "<li><a href='javascript:void(0)' onclick='nav(-1)' aria-label='Previous'><span aria-hidden='true'>&laquo;</span></a></li>";
            // $singlePage = "<li><a href='javascript:void(0)' onclick='nav(" + (j + 1) + ")'><span aria-hidden='true'>&laquo;</span></a></li>";
            $nextPage = "<li><a href='javascript:void(0)' onclick='nav(1)' aria-label='Next'><span aria-hidden='true'>&raquo;</span></a></li>";

            $pageNav.html($previousPage + $singlePage + $nextPage);
        });

    }

    function nav(i) {
        if (pageNum === 0 && i === -1) {
            alert("已经是第一页！");
            return;
        }
        if (i === -1) {
            getImageInfoPage(--pageNum);
            return;
        }
        if (i === 1 && nextPage) {
            getImageInfoPage(++pageNum);
        } else {
            alert("已经是最后一页！");
        }
    }

    //无条件查询 分页
    function getAllImageInfoPage(i) {

        $.get("/image/get/page/all", {pageNum: i, pageSize: pageSize}, function (data) {

            console.log("无条件 查询 分页");
            console.log(data);

        });
    }
</script>